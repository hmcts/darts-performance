plugins {
    id 'java'
    id 'uk.gov.hmcts.java' version '0.12.63'
    id 'io.gatling.gradle' version '3.11.5.2'
}

group = 'uk.gov.hmcts'
version = '0.0.1'

repositories {
    mavenLocal()
    mavenCentral()
    maven { url 'https://jitpack.io' }
}

dependencyCheck {
    suppressionFile = 'config/owasp/suppressions.xml'
}

dependencies {
    gatling group: 'org.postgresql', name: 'postgresql', version: '42.7.4'
    gatling 'com.github.hmcts:juror-generation-support-library:1.5.4'
}

// Default gatlingRun configuration
gatlingRun {
    simulationClassName = System.getenv("simulationClassName")
    doLast {
        println "Running simulation: " + System.getenv("simulationClassName")
    }
}

// Task for GetCatFacts
tasks.register('runAudioPostSimulation') {
    doLast {
        println "Running simulation: simulations.Scripts.DartsApi.AudioPostSimulation"
    }
    // Set the simulation class and make this task depend on gatlingRun
    finalizedBy(gatlingRun) // Ensure gatlingRun executes after this task
    gatlingRun.simulationClassName = 'simulations.Scripts.DartsApi.AudioPostSimulation'
}

// Task for GetListOfCatFacts
tasks.register('runAddCaseUserSimulation') {
    doLast {
        println "Running simulation: simulations.Scripts.DartsSoap.AddCaseUserSimulation"
    }
    // Set the simulation class and make this task depend on gatlingRun
    finalizedBy(gatlingRun) // Ensure gatlingRun executes after this task
    gatlingRun.simulationClassName = 'simulations.Scripts.DartsSoap.AddCaseUserSimulation'
}




checkstyleGatling {
    maxWarnings = 3035
}

tasks.register('runAllStyleChecks') {
    dependsOn 'checkstyleMain'
    dependsOn 'checkstyleTest'
    dependsOn 'checkstyleGatling'
}